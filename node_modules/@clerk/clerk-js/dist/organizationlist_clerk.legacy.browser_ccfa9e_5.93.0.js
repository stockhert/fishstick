"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["158"],{91816:function(t,e,i){i.d(e,{$:()=>_}),i(65223);var a=i(74328),n=i(83799),o=i(69144),r=i(2672),l=i(70431),s=i(19460),c=i(68487),d=i(92654),u=i(53412),g=i(67263),h=i(7259),p=i(88870),z=i(36788),v=i(79281),m=i(64204),Z=i(96519),S=i(17703),b=i(88493),C=i(45727),x=i(8181),f=i(57484);let _=(0,r.withCardStateProvider)(t=>{var e,i;let _=(0,r.useCardState)(),L=(0,v.a2)({onNextStep:()=>_.setError(void 0)}),w=o.useRef(null),{createOrganization:y,isLoaded:$,setActive:P,userMemberships:k}=(0,n.eW)({userMemberships:f.AO.userMemberships}),{organization:A}=(0,n.o8)(),[O,B]=o.useState(),D=(0,z.Yp)("name","",{type:"text",label:(0,S.u1)("formFieldLabel__organizationName"),placeholder:(0,S.u1)("formFieldInputPlaceholder__organizationName")}),I=(0,z.Yp)("slug","",{type:"text",label:(0,S.u1)("formFieldLabel__organizationSlug"),placeholder:(0,S.u1)("formFieldInputPlaceholder__organizationSlug")}),T=!!D.value,K=async e=>{if((e.preventDefault(),T)&&$)try{var i,a;let e={name:D.value};t.hideSlug||(e.slug=I.value);let n=await y(e);if(O&&await n.setLogo({file:O}),w.current=n,await P({organization:n}),null==(i=k.revalidate)||i.call(k),null!=(a=t.skipInvitationScreen)?a:1===n.maxAllowedMemberships)return R();L.nextStep()}catch(t){(0,p.S3)(t,[D,I],_.setError)}},R=()=>{var e,i;null==(e=t.navigateAfterCreateOrganization)||e.call(t,w.current),null==(i=t.onComplete)||i.call(t)},F=t=>{I.setValue(t)},E="organizationList"===t.flow?"subtitle":void 0;return(0,a.BX)(v.en,{...L.props,children:[(0,a.tZ)(c.Y,{headerTitle:null==t||null==(e=t.startPage)?void 0:e.headerTitle,headerSubtitle:null==t||null==(i=t.startPage)?void 0:i.headerSubtitle,headerTitleTextVariant:"h2",headerSubtitleTextVariant:E,sx:t=>({minHeight:t.sizes.$60,gap:t.space.$6,textAlign:"left"}),children:(0,a.BX)(l.l.Root,{onSubmit:K,sx:t=>({gap:t.space.$6}),children:[(0,a.tZ)(m.Col,{children:(0,a.tZ)(x.D,{organization:{name:D.value},onAvatarChange:async t=>await B(t),onAvatarRemove:O?()=>(_.setIdle(),B(null)):null,avatarPreviewPlaceholder:(0,a.tZ)(u.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,a.tZ)(m.Icon,{size:"md",icon:Z.gq,sx:t=>({color:t.colors.$colorMutedForeground,transitionDuration:t.transitionDuration.$controls})}),sx:t=>({width:t.sizes.$16,height:t.sizes.$16,borderRadius:t.radii.$md,borderWidth:t.borderWidths.$normal,borderStyle:t.borderStyles.$dashed,borderColor:t.colors.$borderAlpha200,backgroundColor:t.colors.$neutralAlpha50,":hover":{backgroundColor:t.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})})}),(0,a.tZ)(l.l.ControlRow,{elementId:D.id,children:(0,a.tZ)(l.l.PlainInput,{...D.props,onChange:t=>{D.setValue(t.target.value),F((0,h.q)(t.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),!t.hideSlug&&(0,a.tZ)(l.l.ControlRow,{elementId:I.id,children:(0,a.tZ)(l.l.PlainInput,{...I.props,onChange:t=>{F(t.target.value)},isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,a.BX)(s.K,{sx:t=>({marginTop:t.space.$none}),children:[(0,a.tZ)(l.l.SubmitButton,{block:!1,isDisabled:!T,localizationKey:(0,S.u1)("createOrganization.formButtonSubmit")}),t.onCancel&&(0,a.tZ)(l.l.ResetButton,{localizationKey:(0,S.u1)("userProfile.formButtonReset"),block:!1,onClick:t.onCancel})]})]})}),(0,a.tZ)(c.Y,{headerTitle:(0,S.u1)("organizationProfile.invitePage.title"),headerTitleTextVariant:"h2",headerSubtitleTextVariant:E,sx:t=>({minHeight:t.sizes.$60,textAlign:"left"}),children:A&&(0,a.tZ)(b.l,{resetButtonLabel:(0,S.u1)("createOrganization.invitePage.formButtonReset"),onSuccess:L.nextStep,onReset:R})}),(0,a.BX)(m.Col,{children:[(0,a.tZ)(d.h.Root,{children:(0,a.tZ)(d.h.Title,{localizationKey:(0,S.u1)("organizationProfile.invitePage.title"),sx:{textAlign:"left"}})}),(0,a.tZ)(g.I,{contents:(0,a.tZ)(C.a,{}),sx:t=>({minHeight:t.sizes.$60}),onFinish:R})]})]})})},30683:function(t,e,i){i.r(e),i.d(e,{OrganizationList:()=>E});var a=i(74328),n=i(11576),o=i(64204),r=i(24676);i(65223);var l=i(83799),s=i(69144),c=i(20237),d=i(42305),u=i(92418),g=i(2672),h=i(92654),p=i(76028),z=i(96519),v=i(91816);let m=t=>(0,a.tZ)(c.o2,{elementDescriptor:o.descriptors.organizationListPreviewItems,...t}),Z=t=>(0,a.tZ)(c.ij,{elementId:"organizationList",elementDescriptor:o.descriptors.organizationListPreviewItem,...t}),S=t=>(0,a.tZ)(c.De,{elementDescriptor:o.descriptors.organizationListPreviewItemActionButton,...t}),b=t=>(0,a.tZ)(c.Td,{elementDescriptor:o.descriptors.organizationListPreviewButton,...t});var C=i(88870),x=i(57484),f=i(29325),_=i(35973),L=i(62915);let w=t=>{let{user:e}=(0,l.aF)(),i=(0,g.useCardState)(),{navigateAfterSelectOrganization:r}=(0,n.useOrganizationListContext)(),{t:s}=(0,o.useLocalizations)(),{isLoaded:d,setActive:u}=(0,l.eW)();return d?(0,a.tZ)(b,{onClick:()=>{let a;return a=t.organization,i.runAsync(async()=>{try{await u({organization:a}),await r(a)}catch(a){var t,n;if(!(0,f.kD)(a))return void(0,C.S3)(a,[],i.setError);switch(null==(n=a.errors)||null==(t=n[0])?void 0:t.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":(null==e?void 0:e.createOrganizationEnabled)?i.setError(s((0,o.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):i.setError(s((0,o.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,C.S3)(a,[],i.setError)}}})},children:(0,a.tZ)(_.Z,{elementId:"organizationList",mainIdentifierSx:c.fq,organization:t.organization})}):null},y=(0,g.withCardStateProvider)(()=>{let t=(0,g.useCardState)(),{hidePersonal:e,navigateAfterSelectPersonal:i}=(0,n.useOrganizationListContext)(),{isLoaded:r,setActive:s}=(0,l.eW)(),{user:d}=(0,l.aF)();if(!d)return null;let{username:u,primaryEmailAddress:h,primaryPhoneNumber:p,...z}=d;return e?null:(0,a.tZ)(b,{onClick:()=>{if(r)return t.runAsync(async()=>{await s({organization:null}),await i(d)})},children:(0,a.tZ)(L.g,{user:z,mainIdentifierSx:c.fq,title:(0,o.localizationKeys)("organizationSwitcher.personalWorkspace")})})}),$={infinite:!0},P={infinite:!0},k={infinite:!0,status:["pending","accepted"]},A=t=>{let e=(0,g.useCardState)();return(0,a.tZ)(S,{isLoading:e.isLoading,onClick:t.onAccept,localizationKey:(0,o.localizationKeys)("organizationList.action__invitationAccept")})},O=(0,g.withCardStateProvider)(t=>{let e=(0,g.useCardState)(),{getOrganization:i}=(0,l.cL)(),[n,o]=(0,s.useState)(null),{userInvitations:r}=(0,l.eW)({userInvitations:P,userMemberships:$});return n?(0,a.tZ)(w,{organization:n}):(0,a.tZ)(Z,{organizationData:t.publicOrganizationData,children:(0,a.tZ)(A,{onAccept:()=>e.runAsync(async()=>[await t.accept(),await i(t.publicOrganizationData.id)]).then(t=>{var e;let[i,a]=t;null==r||null==(e=r.setData)||e.call(r,t=>(0,x.Sz)(i,t,"negative")),o(a)}).catch(t=>(0,C.S3)(t,[],e.setError))})})}),B=t=>{let e=(0,g.useCardState)(),{userSuggestions:i}=(0,l.eW)({userSuggestions:k});return"accepted"===t.status?(0,a.tZ)(o.Text,{colorScheme:"secondary",localizationKey:(0,o.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,a.tZ)(S,{isLoading:e.isLoading,onClick:()=>e.runAsync(t.accept).then(t=>{var e;return null==i||null==(e=i.setData)?void 0:e.call(i,e=>(0,x.Sz)(t,e))}).catch(t=>(0,C.S3)(t,[],e.setError)),localizationKey:(0,o.localizationKeys)("organizationList.action__suggestionsAccept")})},D=(0,g.withCardStateProvider)(t=>(0,a.tZ)(Z,{organizationData:t.publicOrganizationData,children:(0,a.tZ)(B,{...t})})),I=t=>{let{onCreateOrganizationClick:e}=t,{user:i}=(0,l.aF)();return(null==i?void 0:i.createOrganizationEnabled)?(0,a.tZ)(d.aU,{elementDescriptor:o.descriptors.organizationListCreateOrganizationActionButton,icon:z.mm,label:(0,o.localizationKeys)("organizationList.action__createOrganization"),onClick:e,sx:t=>({borderTopWidth:t.borderWidths.$normal,borderTopStyle:t.borderStyles.$solid,borderTopColor:t.colors.$borderAlpha100,padding:"".concat(t.space.$5," ").concat(t.space.$5)}),iconSx:t=>({width:t.sizes.$9,height:t.sizes.$6})}):null},T=(0,g.withCardStateProvider)(()=>{let{userMemberships:t,userSuggestions:e,userInvitations:i}=(0,p.H)(),r=(null==t?void 0:t.isLoading)||(null==i?void 0:i.isLoading)||(null==e?void 0:e.isLoading),l=!!((null==t?void 0:t.count)||(null==i?void 0:i.count)||(null==e?void 0:e.count)),{hidePersonal:s}=(0,n.useOrganizationListContext)();return(0,a.BX)(u.Z.Root,{children:[(0,a.BX)(u.Z.Content,{sx:t=>({padding:"".concat(t.space.$8," ").concat(t.space.$none," ").concat(t.space.$none)}),children:[r&&(0,a.tZ)(o.Flex,{direction:"row",align:"center",justify:"center",sx:t=>({height:"100%",minHeight:t.sizes.$60}),children:(0,a.tZ)(o.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})}),!r&&(0,a.tZ)(K,{showListInitially:!(s&&!l)})]}),(0,a.tZ)(u.Z.Footer,{})]})}),K=t=>{let{showListInitially:e}=t,i=(0,g.useCardState)(),{navigateAfterCreateOrganization:r,skipInvitationScreen:l,hideSlug:c}=(0,n.useOrganizationListContext)(),[d,h]=(0,s.useState)(!e);return(0,a.BX)(a.HY,{children:[!d&&(0,a.tZ)(R,{onCreateOrganizationClick:()=>h(!0)}),d&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.Z.Alert,{sx:t=>({margin:"".concat(t.space.$none," ").concat(t.space.$5)}),children:i.error}),(0,a.tZ)(o.Box,{sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$5," ").concat(t.space.$5)}),children:(0,a.tZ)(v.$,{flow:"organizationList",startPage:{headerTitle:(0,o.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:l,navigateAfterCreateOrganization:t=>r(t).then(()=>h(!1)),onCancel:e&&d?()=>h(!1):void 0,hideSlug:c})})]})]})},R=t=>{var e,i,r;let l=(0,g.useCardState)(),s=(0,n.useEnvironment)(),{ref:z,userMemberships:v,userSuggestions:Z,userInvitations:S}=(0,p.H)(),{hidePersonal:b}=(0,n.useOrganizationListContext)(),C=(null==v?void 0:v.isLoading)||(null==S?void 0:S.isLoading)||(null==Z?void 0:Z.isLoading),x=(null==v?void 0:v.hasNextPage)||(null==S?void 0:S.hasNextPage)||(null==Z?void 0:Z.hasNextPage),f=null==(e=S.data)?void 0:e.filter(t=>!!t),_=null==(i=Z.data)?void 0:i.filter(t=>!!t);return(0,a.BX)(a.HY,{children:[(0,a.BX)(h.h.Root,{sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$8)}),children:[(0,a.tZ)(h.h.Title,{localizationKey:(0,o.localizationKeys)(b?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,a.tZ)(h.h.Subtitle,{localizationKey:(0,o.localizationKeys)("organizationList.subtitle",{applicationName:s.displayConfig.applicationName})})]}),(0,a.tZ)(u.Z.Alert,{sx:t=>({margin:"".concat(t.space.$none," ").concat(t.space.$5)}),children:l.error}),(0,a.tZ)(o.Col,{elementDescriptor:o.descriptors.main,children:(0,a.tZ)(m,{children:(0,a.BX)(d.eX,{role:"menu",children:[(0,a.tZ)(y,{}),(v.count||0)>0&&(null==(r=v.data)?void 0:r.map(t=>(0,a.tZ)(w,{...t},t.id))),!v.hasNextPage&&(null==f?void 0:f.map(t=>(0,a.tZ)(O,{...t},t.id))),!v.hasNextPage&&!S.hasNextPage&&(null==_?void 0:_.map(t=>(0,a.tZ)(D,{...t},t.id))),(x||C)&&(0,a.tZ)(c.pr,{ref:z}),(0,a.tZ)(I,{onCreateOrganizationClick:()=>{l.setError(void 0),t.onCreateOrganizationClick()}})]})})})]})},F=(0,n.withCoreUserGuard)(T),E=()=>(0,a.tZ)(o.Flow.Root,{flow:"organizationList",children:(0,a.tZ)(o.Flow.Part,{children:(0,a.tZ)(r.Switch,{children:(0,a.tZ)(r.Route,{children:(0,a.tZ)(F,{})})})})})}}]);